## 1D-kMQC: A set of reciprocal-space MQC codes for 1-D lattice models of electron-phonon scattering. 

This codebase includes an implementation of mean-field (MF) [1] and surface hopping (FSSH) [2] methods
in real and reciprocal space for 1-D lattices consisting of nearest-neighbor interactions with electron-phonon couplings modeled as either 
Holstein or Peierls interactions. In reciprocal space one can perform dynamics in a truncated Brillouin zone.
These codes can be used to reproduce the calculations performed in [3]
and [4] for MF and FSSH respectively.

## Files  
* Libraries needed: `libraries.py` 
* MF dynamics: `kMQC-MF.py`
* FSSH dynamics: `kMQC-FSSH.py`
* initial wavefunction in real-space (corresponding to the k=0 state): `coeffgrid_rspace`
* initial wavefunction in reciprocal-space (k=0 state): `coeffgrid_kspace`

## Basic Usage
1. Navigate to the example directories containing the input files, for example: `examples/k-space-MF/` for 
a mean-field calculation in reciprocal space. All files needed for a calculation are already present in those folders including the inputfile 
` inputfile_holstein` (for a holstein type coupling). 
2. The inputfile contains a description of all the necessary parameters for defining the physical system 
and simulation, modify the inputs as needed. An example is reproduced here:
    ```
    npoints = 12 # number of points in untruncated lattice, must be even
    space = 'k-space' # representation 'k-space' or 'r-space'
    model = 'holstein' # model, holstein or peierls
    coeff_file = 'coeffgrid_kspace' # file containing initial wavefunction coefficient
    nprocs = 2 # number of processors to use
    ntrials = 2 # number of trials, should be integer multiple of nprocs
    tmax = 100 # maximum time
    dt = .1 # output time interval
    dt_bath = .02 # dynamics time interval
    temp = 0.5 # temperature
    gc = 2 # electron-phonon coupling
    J = -1.0 # nearest-neighbor coupling integral (sign convention is reversed)
    w = 0.2 # classical oscillator frequency
    rvar = 2 # inverse of truncation radius in units of pi/a (2 is 50% of the BZ included, 1 is 100% of BZ included)
   ```
3. Perform the simulation by executing the relevant script. For MF calculations:
    ```bash
   python /path/to/kMQC-MF.py inputfile_holstein 
   ```
    for FSSH calculations:
    ```bash
   python /path/to/kMQC-FSSH.py inputfile_holstein 
   ```
4. The output of the calculation is created in a new folder with a name (filename) generated by the input parameters. 
The output files contained therein are:
    * Diabatic populations: `filename_resCdb.csv`
    * Fourier transformed diabatic populations: `filename_resFcdb.csv`
    * Diabatic Boltzmann populations: `filename_resPopB.csv`
    * Fourier transformed diabatic Boltzmann populations: `filename_resFcpopB.csv`
    * Classical energy: `filename_resEc.csv`
    * Quantum energy: `filename_resEq.csv`
    * Time axis of output data: `filename_resT.csv`
    * Quantum Hamiltonian eigenvalues: `wgridQ.csv`
    * Classical oscillator frequencies: `wgrid.csv`

## References
[1] Tully, J. C. Mixed Quantum–Classical Dynamics. Faraday Discuss. 110, 1998, 407–419.

[2] Hammes-Schiffer, S. and Tully, J. C. Proton Transfer in Solution: Molecular Dynamics with Quantum Transitions. J. Chem. Phys. 101, 1994, 4657–4667.

[3] Krotz, A.; Provazza, J., and Tempelaar, R. A Reciprocal-Space Formulation of Mixed Quantum–
Classical Dynamics. J. Chem. Phys. 154, 2021, 224101 [https://doi.org/10.1063/5.0053177](https://doi.org/10.1063/5.0053177)

[4] Krotz, A. and Tempelaar, R. A Reciprocal-Space Formulation of Surface Hopping. J. Chem.
Phys. 156, 2022, 024105. [https://doi.org/10.1063/5.0076070](https://doi.org/10.1063/5.0076070)


